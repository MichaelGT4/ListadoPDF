var rp=rp||{};if(void 0===rp.chat){if(rp.chat={isInitiated:!1,inviteEnabled:1,chatWindow:"default",setChatWindow:function(t){return this.chatWindow=void 0!==t?t:"default",!0},getChatWindow:function(){return this.chatWindow},enableInvite:function(){return clearTimeout(rp.chat.Core.resLoadStatus),setTimeout(function(){startLoadStatus()},7e3),!0},disableInvite:function(){return this.inviteEnabled=0,rp.chat.BusinessRule&&rp.chat.BusinessRule.hideInvitation(),!0},isInviteEnabled:function(){return this.inviteEnabled},updatedCustomValues:function(){return void 0!==rp.chat.Core&&rp.chat.Core.loadStatus(1),!0},triggerBusinessRuleEvent:function(t,e,o){return void 0!==rp.chat.Core&&("undefined"==typeof rpChatConfig&&(rpChatConfig={}),rpChatConfig.customValues=rpChatConfig.customValues||{},rpChatConfig.customValues.businessRuleEvent={brEventId:t,brEventName:e,brEventPayload:o},rp.chat.Core.loadStatus(1)),!0},enable:function(){return void 0!==rpChatConfig.enabled&&!1!==rpChatConfig.enabled||(rpChatConfig.enabled=!0,rp.chat.Core.loadConfig()),this},disable:function(){return rpChatConfig.enabled=!1,window.clearTimeout(rp.chat.Core.resLoadStatus),rp.chat.Core.removeStatusbutton(),rp.chat.BusinessRule&&rp.chat.BusinessRule.hideInvitation(),this},changePage:function(t){return void 0!==t&&(rpChatConfig=t),void 0===rpChatConfig.enabled||!0===rpChatConfig.enabled?this.disable().enable():this.disable(),this},loadModules:function(){"boolean"!=typeof navigator.cookieEnabled||navigator.cookieEnabled?(rp.chat.isInitiated=!0,this.Core=new rp.chat.CoreModul,this.Chat=new rp.chat.ChatModul):"undefined"!=typeof console&&console.log("Cookies aktivieren um den Chat zu nutzen")},loadLayerModul:function(t){var e=rp.chat.Core.getConfig();this.LayerChat||"layer"!==e.chatType||(this.LayerChat=new rp.chat.LayerChatModul),this.LayerChat||"layer2"!==e.chatType||(this.LayerChat=new rp.chat.LayerChatModuleV2),"function"==typeof t&&t()},loadWebRTCModul:function(){"undefined"!=typeof DetectRTC&&DetectRTC.load(function(){!DetectRTC.isWebRTCSupported||DetectRTC.browser.isIE||DetectRTC.browser.isEdge||rp.chat.Core.setWebRTCDetected(1)})},loadRpFpModul:function(){"undefined"!=typeof Fingerprint2&&(new Fingerprint2).get(function(t){rp.chat.Core.setFp(t)})},startLoadStatus:function(){this.inviteEnabled=1,clearTimeout(rp.chat.Core.resLoadStatus),rp.chat.Core.resLoadStatus=setTimeout("rp.chat.Core.loadStatus()",0)},checkAvailability:function(t){var e=rp.chat.Core.getDeptId(),o=rp.chat.Core.getRPDomain("dialog");rp.chat.Core.getJQ().getJSON(o+"/rest/v1.0/availability/"+e).done(function(e){"function"==typeof t&&t(e)})},sendMessage:function(t){(t=void 0!==t?t:{}).action="sendMessage",t.visitorId=rp.chat.Core.getSessionRp(),t.deptId=rp.chat.Core.getDeptId();var e=rp.chat.Core.getConfig();return void 0!==e.chatType&&"layer2"!==e.chatType&&(rp.chat.Core.getJQ().ajax({url:rp.chat.Core.getRPDomain("dialog")+"/layer/blank.php",type:"POST",data:t,cache:!1}),!0)},loadScript:function(t,e){e=e||function(){};var o=document.createElement("script");o.async=!0,o.src=t,o.addEventListener("load",function(){e()}),document.getElementsByTagName("body")[0].appendChild(o)}},rp.chat.CoreModul=function(){var that=this,urlCollect=document.scripts.realpersonChatLoader.src.substr(0,document.scripts.realpersonChatLoader.src.indexOf("scripts/loadchatmodul")).slice(0,-1),jq=null,config={},status={},currentUrl=escape(location.toString()),referUrl=escape(document.referrer),sessionrp="",sidOpti="",countLoadStatusRequests=0,webRTCDetected=0,rpfp="",cookieUpdatedOnlineberatung=0;this.resLoadStatus=null,this.loadConfigCounter=0;var configLoaded=0,chatWasOpened=!1;this.getJQ=function(){return jq},this.documentReady=function(t){if("function"==typeof t)return"complete"===document.readyState||"interactive"==document.readyState?t():void document.addEventListener("DOMContentLoaded",t,!1)},this.getAjaxDataType=function(){return(urlCollect.indexOf("://")>-1?urlCollect.split("/")[2]:"")===document.domain?"json":"jsonp"},this.getRPDomain=function(t){return void 0===t||"collect"===t?urlCollect:config.urlDialog?config.urlDialog:""},this.getStatus=function(){return status},this.startChat=function(t,e){if(0==Object.keys(config).length)return!1;var o="";if(void 0===e)o="text";else{o=/(video|text)/i.test(e)?e:"text"}var n=rp.chat.BusinessRule?rp.chat.BusinessRule.getCurrentBusinessRuleId(t):0;if(n&&window.at&&rpChatConfig.customValues&&rpChatConfig.customValues.businessRuleEvent&&rpChatConfig.customValues.businessRuleEvent.brEventPayload&&window.at("trigger","claim",rpChatConfig.customValues.businessRuleEvent.brEventPayload.measure),rp.chat.BusinessRule&&rp.chat.BusinessRule.hideInvitation(),rpChatConfig.checkTrackingAllowed()&&void 0!==config.trackRpFp&&config.trackRpFp&&!/Version\/([\d\w\.\-]+) Safari\/605.1.15/i.test(navigator.userAgent)&&this.setRpFp(),"layer2"===config.chatType||void 0===config.isMobile&&"mobile"!=rp.chat.getChatWindow())if(config.isLayerChat&&"text"==o&&"default"==rp.chat.getChatWindow()||"layer"==rp.chat.getChatWindow()){if(!config.statusbutton[o].onlinestatus&&void 0!==config.statusbutton[o].offlineUrl)return window.open(rp.chat.Core.getRPDomain("dialog")+"/redirect.php?action=offlineurl&session_rp="+rp.chat.Core.getSessionRp()+"&deptid="+rp.chat.Core.getDeptId(),"_blank",""),!1;if("layer"===config.chatType&&rp.chat.Core.loadLayerChatModule(function(){rp.chat.LayerChat.setLayer(t,o,n)}),"layer2"===config.chatType){if(config&&config.forcePopup&&(void 0===rpChatConfig.forcePopup||!0===rpChatConfig.forcePopup)){rp.chat.updatedCustomValues();var i="location=no,menubar=no,scrollbars=no,resizable=1,screenX=50,screenY="+("undefined"!=typeof screen&&screen.height>=config.chatWindow.size.height?0:100)+",width=430,height=600",a=rp.chat.Core.getRPDomain("dialog")+"/layer-v2/popup/"+rp.chat.Core.getDeptId()+"/"+t+"/"+o+"/"+n+"/"+sessionrp;return window.open(a,"",i),!1}rp.chat.Core.loadLayerChatModuleV2(function(){triggerEvent(document,"rp-start-chat"),rp.chat.LayerChat.setLayer(t,o,n)})}}else rp.chat.Chat.startPopupChat(t,o,config,n);else rp.chat.Chat.startMobileChat(t,o,config,n);return chatWasOpened=!0,"popup"===config.chatType&&(clearTimeout(rp.chat.Core.resLoadStatus),rp.chat.Core.resLoadStatus=setTimeout("rp.chat.Core.loadStatus()",5e3)),!1},this.removeStatusbutton=function(){jq("span#optiRealPersonContent #realperson_text_status_button").remove(),jq("span#optiRealPersonContent #realperson_video_status_button").remove()},this.getCurrentUrl=function(){return currentUrl},this.getDeptId=function(){return"undefined"!=typeof rpChatConfig&&void 0!==rpChatConfig.deptId?rpChatConfig.deptId:0},this.getSessionRp=function(){return escape(sessionrp)},this.getSidOpti=function(){return sidOpti||isValidCookieOnlineBeratung(),escape(sidOpti)},this.getCobrowsingUserName=function(){return void 0!==status.cobrowsing&&status.cobrowsing.user_name?status.cobrowsing.user_name:""},this.getCobrowsingUserImage=function(){return void 0!==status.cobrowsing&&status.cobrowsing.user_image?status.cobrowsing.user_image:""},this.getWebRTCDetected=function(){return webRTCDetected},this.setWebRTCDetected=function(t){webRTCDetected=t},this.getFp=function(){return rpfp},this.setFp=function(t){rpfp=t},this.getConfig=function(){return config},this.getBrowserWidth=function(){return document.body.offsetWidth?document.body.offsetWidth:window.outerWidth?window.outerWidth:0},this.getBrowserHeight=function(){return document.body.offsetWidth?window.innerHeight:document.body.offsetHeight?document.body.offsetHeight:0};var setConfigLoaded=function(t){configLoaded=t};this.setConfigEntry=function(t,e){config[t]=e},this.loadConfig=function(){"undefined"!=typeof rpChatConfig&&void 0!==rpChatConfig.enabled&&0==rpChatConfig.enabled||("undefined"==typeof rpChatConfig&&(rpChatConfig={}),rpChatConfig.enabled=!0,setConfigLoaded(1),this.documentReady(function(){that.loadConfigCounter++;var t=urlCollect+"/scripts/loadconfig.php",e={};"undefined"!=typeof rpChatConfig&&(e=rpChatConfig.customValues||{});var o={deptid:that.getDeptId(),pageurl:currentUrl,session_rp:sessionrp,deptlist:getCookieDeptList(),referer:referUrl,screen_width:document.body.clientWidth,start_admin_cobrowsing:null!==new RegExp("[#]rpcobrowsing=([^&#]*)").exec(window.location.href)?new RegExp("[#]rpcobrowsing=([^&#]*)").exec(window.location.href)[1]:"",customValues:JSON.stringify(e).replace(/<.*?>/g,""),load_config_counter:that.loadConfigCounter,current_time:Math.floor((new Date).getTime()/1e3),cpid:null!==new RegExp("cpid=([^&#]*)").exec(window.location.href)?new RegExp("cpid=([^&#]*)").exec(window.location.href)[1]:e.cpid||""},n=new XMLHttpRequest;n.open("POST",t,!0),n.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),n.setRequestHeader("Accept","application/json, text/javascript"),n.onreadystatechange=function(){4==n.readyState&&200==n.status&&that.loadConfigSuccess(JSON.parse(n.response))};JSON.stringify(o);var i="";for(var a in o)i+=a+"="+o[a]+"&";n.send(i)}))},this.loadConfigSuccess=function(t){if("function"==typeof jq){if(that.loadConfigCounter!=t.loadConfigCounter)return!1;if(void 0!==t.cobrowsing&&void 0!==t.cobrowsing.url&&(window.location.href=t.cobrowsing.url),void 0!==t.hasRealpersonLogin&&(void 0===rpChatConfig.customValues&&(rpChatConfig.customValues={}),rpChatConfig.customValues.hasRealpersonLogin=t.hasRealpersonLogin),void 0!==t.whitelistblocked)return!1;if(jq.extend(config,t),setCookieSession(),transferExtCookieOnlineBeratung(),jq.ajaxSetup({data:{session_rp:sessionrp}}),void 0!==config.businessRule&&jq.ajax({url:urlCollect+"/scripts/loadbusinessrules.js",dataType:"script",data:{session_rp:null},success:function(){rp.chat.BusinessRule=new rp.chat.BusinessRuleModule,rp.chat.BusinessRule.registerEvents()}}),void 0!==config.checkAdBlock&&void 0===rp.chat.AdBlock){var e=document.createElement("script");e.src=urlCollect+"/third-party/blockadblock/blockadblock.js",document.head.appendChild(e)}if("undefined"==typeof DetectRTC?void 0!==config.hasVideoSupport&&config.hasVideoSupport&&jq.ajax({url:urlCollect+"/third-party/webrtc/DetectRTC.min.js",dataType:"script",data:{session_rp:null},success:function(){rp.chat.loadWebRTCModul()}}):rp.chat.loadWebRTCModul(),rpChatConfig.checkTrackingAllowed()&&void 0!==config.trackRpFp&&config.trackRpFp&&!/Version\/([\d\w\.\-]+) Safari\/605.1.15/i.test(navigator.userAgent)&&jq.ajax({url:urlCollect+"/third-party/rpfp/rpfp.min.js",dataType:"script",data:{session_rp:null},success:function(){"layer2"===config.chatType?setTimeout(function(){rp.chat.loadRpFpModul(),setTimeout(function(){rp.chat.Core.loadStatus(1)},500)},1e4):rp.chat.loadRpFpModul()}}),void 0!==config.statusbutton.text.css){var o=document.head||document.getElementsByTagName("head")[0];(n=document.createElement("style")).type="text/css",n.styleSheet?n.styleSheet.cssText=config.statusbutton.text.css:n.appendChild(document.createTextNode(config.statusbutton.text.css)),o.appendChild(n)}if(void 0!==config.statusbutton.video.css){var n;o=document.head||document.getElementsByTagName("head")[0];(n=document.createElement("style")).type="text/css",n.styleSheet?n.styleSheet.cssText=config.statusbutton.video.css:n.appendChild(document.createTextNode(config.statusbutton.video.css)),o.appendChild(n)}var i=!1;if(0==jq("link[href='"+urlCollect+"/css/realperson-code.css']").length){var a=document.createElement("link");a.type="text/css",a.rel="stylesheet",a.href=urlCollect+"/css/realperson-code.css";var r=function(t){a.removeEventListener("load",r),i=!0};a.addEventListener("load",r),document.getElementsByTagName("head")[0].appendChild(a)}else i=!0;var s=!1;if(config.theme&&0==jq("link[href='"+urlCollect+"/layouts/"+config.theme+"/css/realperson-code.css']").length){var c=document.createElement("link");c.type="text/css",c.rel="stylesheet",c.href=urlCollect+"/layouts/"+config.theme+"/css/realperson-code.css";var u=function(t){c.removeEventListener("load",u),s=!0};c.addEventListener("load",u),document.getElementsByTagName("head")[0].appendChild(c)}else s=!0;var d=!1;if(config.isLayerChat&&("layer"===config.chatType&&rp.chat.Core.loadLayerChatModule(function(){d=!0}),"layer2"===config.chatType&&rp.chat.Core.loadLayerChatModuleV2(function(){d=!0})),void 0!==t.cobrowsing2&&("layer2"===config.chatType||"layer"===config.chatType||"popup"===config.chatType&&void 0===config.isMobile)){var l=document.createElement("script");l.type="text/javascript",l.id="realperson-cobrowsingmodul2",l.src=urlCollect+"/../js/cobrowsing/screensharing-client.js",l.onload=function(){rp.chat.Cobrowsing2=new rp.chat.CobrowsingModul2,rp.chat.Cobrowsing2.initialize()},document.getElementsByTagName("head")[0].appendChild(l)}if(void 0!==t.cobrowsing&&void 0!==t.cobrowsing.cookieList)for(var p in t.cobrowsing.cookieList){var h=t.cobrowsing.cookieList[p];rp.chat.Core.writeCookie(h.name,h.content),window.document.location.href=t.cobrowsing.url}triggerEvent(document,"rp-onlinestatus",{text:!!config.statusbutton.text.onlinestatus,video:!!config.statusbutton.video.onlinestatus}),void 0!==config.cookie&&Object.keys(config.cookie).forEach(function(t){void 0!==config.cookie[t].deleteCookieOnlineberatung&&(document.cookie=config.cookie[t].name+"=; path=/; expires=Fri, 02 Jan 1970 00:00:00 UTC; domain="+getFirstDomainName()+("https:"===window.location.protocol?";secure":""))});var g=function(){i&&s?(loadStatusbutton("text"),loadStatusbutton("video")):setTimeout(g,50)};if(g(),rp.chat.Core.loadStatus(),config.campaign_active){var f=function(){if(!config.isLayerChat||d){var t=!!config.statusbutton.text.onlinestatus;config.campaign_data.show_always>0?t?rp.chat.Core.startChat(40,"text"):rp.chat.Core.startChat(41,"text"):t&&rp.chat.Core.startChat(40,"text")}else setTimeout(f,50)};f()}}else setTimeout(function(){that.loadConfigSuccess(t)},500)},this.loadLayerChatModule=function(t){void 0===rp.chat.LayerChat?jq.ajax({url:urlCollect+"/scripts/loadlayerchatmodul.js",dataType:"script",data:{session_rp:null},success:function(){rp.chat.loadLayerModul(),rp.chat.LayerChat.createLayer(t)}}):rp.chat.LayerChat.createLayer(t)},this.loadLayerChatModuleV2=function(t){if("object"!=typeof rp.chat.LayerChat){var e=document.createElement("script");e.onload=function(){rp.chat.loadLayerModul(function(){rp.chat.LayerChat.bindEvents(),rp.chat.LayerChat.createLayer(t)})},e.src=urlCollect+"/scripts/loadlayerchatmodul-v2.js",document.getElementsByTagName("head")[0].appendChild(e)}else rp.chat.LayerChat.initLayerContent(t)},this.loadStatus=function(onlySaveStatus){if(config.isLayerChat&&void 0===rp.chat.LayerChat||void 0!==config.checkAdBlock&&"function"==typeof rp.chat.Core.getHasAdBlockDetected&&!rp.chat.Core.getHasAdBlockDetected())this.resLoadStatus=setTimeout("rp.chat.Core.loadStatus()",2);else{var isOnlySaveStatus=void 0!==onlySaveStatus,chatLayer=0;void 0!==rp.chat.LayerChat&&(chatLayer=rp.chat.LayerChat.getChatLayerIsActive());var request_url=urlCollect+"/scripts/loadstatus.php",customValue={};"undefined"!=typeof rpChatConfig&&(customValue=rpChatConfig.customValues||{});var coBrowsingUrl="";"undefined"!=typeof TogetherJS&&(coBrowsingUrl=TogetherJS.shareUrl());var isInviteEnabled=1;void 0!==rp.chat.LayerChat&&chatLayer&&(isInviteEnabled=0),this.resLoadStatus=null;var params={deptid:rp.chat.Core.getDeptId(),pageurl:currentUrl,session_rp:sessionrp,inviteEnabled:rp.chat.inviteEnabled&&(tabActive||void 0!==status.autoinvite)?isInviteEnabled:0,chatlayer:chatLayer,customValues:JSON.stringify(customValue),cobrowsingurl:coBrowsingUrl,adblock_detected:"function"==typeof rp.chat.Core.getAdBlockDetected?rp.chat.Core.getAdBlockDetected():0,count_status_requests:countLoadStatusRequests,rpfp:rpChatConfig.checkTrackingAllowed()&&void 0!==config.trackRpFp&&config.trackRpFp?rpfp:""},that=this;jq.ajax({dataType:"json",type:"POST",cache:!1,url:request_url,data:params,success:function(data){status=data,void 0!==data.execute&&jq.each(data.execute,function(index,value){eval(value)}),void 0!==status.autoinvite&&(rp.chat.BusinessRule?rp.chat.BusinessRule.checkInviteStatus():jq.ajax({url:urlCollect+"/scripts/loadbusinessrules.js",dataType:"script",data:{session_rp:null},success:function(){rp.chat.BusinessRule=new rp.chat.BusinessRuleModule,rp.chat.BusinessRule.checkInviteStatus()}})),rp.chat.BusinessRule&&rp.chat.BusinessRule.checkInviteStatus(),isOnlySaveStatus||(checkCobrowsingStatus(),void 0!==config.cookie&&Object.keys(config.cookie).forEach(function(t){void 0!==config.cookie[t].removeByMidnight&&config.cookie[t].removeByMidnight&&0!=cookieUpdatedOnlineberatung&&cookieUpdatedOnlineberatung!=(new Date).getDate()?document.cookie=config.cookie[t].name+"=; path=/; expires=Fri, 02 Jan 1970 00:00:00 UTC; domain="+getFirstDomainName()+("https:"===window.location.protocol?";secure":""):void 0!==config.cookie[t].continuousUpdated&&config.cookie[t].continuousUpdated&&updateCookieOnlineBeratung(t)}),"popup"===config.chatType&&chatWasOpened?status.checkStatus=5:void 0===status.checkStatus&&(status.checkStatus=60),status.checkStatus>0&&(that.resLoadStatus=setTimeout("rp.chat.Core.loadStatus()",1e3*status.checkStatus)))},error:function(){isOnlySaveStatus||(rp.chat.Core.resLoadStatus=setTimeout("rp.chat.Core.loadStatus()",6e4))}}),countLoadStatusRequests+=1}};var checkCobrowsingStatus=function(){var t;void 0!==status.cobrowsing&&status.cobrowsing.load&&(status.cobrowsing.version2?null==document.getElementById("realperson-cobrowsingmodul2")&&((t=document.createElement("script")).type="text/javascript",t.id="realperson-cobrowsingmodul2",t.src=urlCollect+"/../js/cobrowsing/screensharing-client.js",t.onload=function(){rp.chat.Cobrowsing2=new rp.chat.CobrowsingModul2,rp.chat.Cobrowsing2.initialize()},document.getElementsByTagName("head")[0].appendChild(t)):null==document.getElementById("realperson-cobrowsingmodul")&&((t=document.createElement("script")).type="text/javascript",t.id="realperson-cobrowsingmodul",t.src=urlCollect+"/scripts/loadcobrowsingmodul.js",t.onload=function(){rp.chat.Cobrowsing=new rp.chat.CobrowsingModul,rp.chat.Cobrowsing.loadLibrary(status.cobrowsing)},document.getElementsByTagName("head")[0].appendChild(t)));void 0!==status.cobrowsing&&status.cobrowsing.refresh&&"undefined"!=typeof TogetherJS&&TogetherJS.refreshUserData()},loadStatusbutton=function(t){if(1==config.statusbutton[t].onlinestatus?jq("span#optiRealPersonContent").addClass(t+"-online"):jq("span#optiRealPersonContent").addClass(t+"-offline"),void 0!==config.statusbutton[t].src||""!=rp.chat.Core.getTextLinkCaption()){jq("#realperson_"+t+"_status_button").remove();var e=jq("<div>");e.attr("id","realperson_"+t+"_status_button"),e.attr("title",config.statusbutton[t].infotext);var o="";void 0!==config.statusbutton[t].addClass&&""!=config.statusbutton[t].addClass&&(o+=config.statusbutton[t].addClass),void 0!==config.statusbutton[t].animation&&(o+=" realperson-animated "+config.statusbutton[t].animation),o.length>0&&e.attr("class",o),void 0!==config.statusbutton[t].inlineCSS&&""!=config.statusbutton[t].inlineCSS&&e.attr("style",config.statusbutton[t].inlineCSS);var n=jq("<a>");if(n.attr("id","RealpersonChatStatusButtonLink"+t),n.attr("href","javascript:void(0);"),n.css("display","none"),""!=rp.chat.Core.getTextLinkCaption())n.text(rp.chat.Core.getTextLinkCaption());else if(void 0!==config.statusbutton[t].buttonType&&"html"===config.statusbutton[t].buttonType)config.statusbutton[t].onlinestatus||!config.statusbutton[t].onlinestatus&&config.statusbutton[t].offlineClick?void 0!==config.statusbutton[t].clickClass&&""!=config.statusbutton[t].clickClass?void 0!==config.statusbutton[t].delay?setTimeout(function(){jq(e).html(config.statusbutton[t].src)},1e3*config.statusbutton[t].delay):jq(e).html(config.statusbutton[t].src):(n.html(config.statusbutton[t].src),void 0!==config.statusbutton[t].delay?setTimeout(function(){jq(e).append(n)},1e3*config.statusbutton[t].delay):jq(e).html(config.statusbutton[t].src)):e.html(config.statusbutton[t].src);else{var i=jq("<img id='RealpersonChatStatusButton"+t+"'>");i.attr("src",config.statusbutton[t].src),i.attr("title",config.statusbutton[t].infotext),i.attr("alt",config.statusbutton[t].infotext)}""!=rp.chat.Core.getTextLinkCaption()?void 0!==config.statusbutton[t].delay?setTimeout(function(){jq(e).append(n),jq("span#optiRealPersonContent").append(e)},1e3*config.statusbutton[t].delay):(jq(e).append(n),jq("span#optiRealPersonContent").append(e)):void 0!==config.statusbutton[t].buttonType&&"html"===config.statusbutton[t].buttonType?(void 0!==config.statusbutton[t].delay?setTimeout(function(){jq("span#optiRealPersonContent").append(e)},1e3*config.statusbutton[t].delay):jq("span#optiRealPersonContent").append(e),(config.statusbutton[t].onlinestatus||!config.statusbutton[t].onlinestatus&&config.statusbutton[t].offlineClick)&&(void 0!==config.statusbutton[t].clickClass&&""!=config.statusbutton[t].clickClass?jq(document).on("click","#realperson_"+t+"_status_button ."+config.statusbutton[t].clickClass,function(e){e.preventDefault(),rp.chat.Core.startChat(1,t)}):jq("#realperson_"+t+"_status_button").bind("click",function(e){e.preventDefault(),rp.chat.Core.startChat(1,t)}))):config.statusbutton[t].onlinestatus||!config.statusbutton[t].onlinestatus&&config.statusbutton[t].offlineClick?(jq(n).append(i),jq(e).append(n),void 0!==config.statusbutton[t].delay?setTimeout(function(){jq("span#optiRealPersonContent").append(e)},1e3*config.statusbutton[t].delay):jq("span#optiRealPersonContent").append(e),jq(document).on("click","#realperson_"+t+"_status_button",function(e){e.preventDefault(),rp.chat.Core.startChat(1,t)})):(jq(e).append(i),jq("span#optiRealPersonContent").append(e))}},getCookieSession=function(){var t=getCookieContent("REALPERSON_SESSION=");return 0!=t?t:"null"},setCookieSession=function(){isValidCookieSession()||(sessionrp=void 0!==config.createSessionRp?config.createSessionRp:"",document.cookie="REALPERSON_SESSION="+sessionrp+"; path=/; domain="+getFirstDomainName()+("https:"===window.location.protocol?";secure":"")+" ;samesite=none")},isValidCookieSession=function(){var t=getCookieContent("REALPERSON_SESSION=");return 0!=t&&(sessionrp=t),t},setCookieOnlineBeratung=function(t,e){if(!rpChatConfig.checkTrackingAllowed())return!1;e=void 0!==e?e:"default";var o=config.cookie[e],n=new Date;if(n.setTime(n.getTime()+1e3*o.lifetime),void 0===t)if("default"!==e)t=void 0!==o.content?o.content:getCookieOnlineBeratung(),"ONLINEBERATUNG"==o.name&&(sidOpti=t);else{var i=void 0!==config.timeOffset?1e3*config.timeOffset:0;t=(new Date).getTime()+i,"ONLINEBERATUNG"==o.name&&(sidOpti=t)}void 0===o.content&&(t+="%3B"+rp.chat.Core.getDeptId()),document.cookie=o.name+"="+t+"; expires="+n.toGMTString()+"; path=/; domain="+getFirstDomainName()+("https:"===window.location.protocol?";secure":"")+" ;samesite=none",cookieUpdatedOnlineberatung=(new Date).getDate()},updateCookieOnlineBeratung=function(){void 0!==config.isDeptNotInCookieGroup&&setCookieOnlineBeratung(getCookieOnlineBeratung())},getCookieOnlineBeratung=function(t){return getCookieContent((void 0!==t?t:"ONLINEBERATUNG")+"=")},getCookieDeptList=function(){var t=getCookieOnlineBeratung(),e="";return t&&(e=t.substring(-1!==t.indexOf("%3B")?16:13,t.length)),e},transferExtCookieOnlineBeratung=function(){void 0!==config.cookie&&Object.keys(config.cookie).forEach(function(t){var e=getCookieOnlineBeratung(config.cookie[t].name),o=void 0!==config.extCookieOnlineberatung?config.extCookieOnlineberatung:"";if(!e&&o){var n=new Date,i=n.getTime()+1e3*config.cookie[t].lifetime;n.setTime(i);var a=getFirstDomainName();document.cookie=config.cookie[t].name+"="+o+"; expires="+n.toGMTString()+"; path=/; domain="+a+("https:"===window.location.protocol?";secure":"")}})},isValidCookieOnlineBeratung=function(){void 0!==config.cookie&&Object.keys(config.cookie).forEach(function(t){var e=getCookieOnlineBeratung(config.cookie[t].name);e?("default"===t&&(sidOpti=e.substring(0,13)),-1===e.substring(-1!==e.indexOf("%3B")?16:13,e.length).split("%3B").indexOf(rp.chat.Core.getDeptId().toString())&&updateCookieOnlineBeratung(t)):setCookieOnlineBeratung(void 0,t)})},getCookieChatContent=function(){var t=getCookieContent("ChatContent=");return 0!=t?t:"null"},getCookieContent=function(t){var e=document.cookie,o=e.indexOf(t);if(-1!=o){o+=t.length;var n=-1!=e.indexOf(";",o)?e.indexOf(";",o):e.length,i=e.substring(o,n);if(""!=i&&0!=i.trim().length)return i}return!1};this.getPagename=function(){return"undefined"!=typeof rpChatConfig&&void 0!==rpChatConfig.pagename?rpChatConfig.pagename:""},this.getTextLinkCaption=function(){return"undefined"!=typeof rpChatConfig&&void 0!==rpChatConfig.textLinkCaption?rpChatConfig.textLinkCaption:""},this.getFirstDomainName=function(){return getFirstDomainName()};var getFirstDomainName=function(){var t=escape(window.location.hostname.toString()).split("."),e=window.location.hostname;return t.length>3?e=t[t.length-3]+"."+t[t.length-2]+"."+t[t.length-1]:t.length>1&&(e=t[t.length-2]+"."+t[t.length-1]),e};this.getTabActive=function(){return tabActive},this.writeCookie=function(t,e){document.cookie=t+"="+e+"; path=/"+("https:"===window.location.protocol?";secure":"")};var loadJQuery=function(){if("function"==typeof jQuery)(jq=jQuery).ajaxSetup({cache:!0,async:!0,traditional:!1,xhrFields:{withCredentials:!0}}),registerEventMessages();else{var t=document.createElement("script");t.type="text/javascript",t.async=!0,t.id="realpersonChatJquery",t.src="https://code.jquery.com/jquery-3.4.1.min.js",t.crossOrigin="anonymous",t.integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=",t.onload=function(){(jq=jQuery.noConflict()).ajaxSetup({cache:!0,async:!0,traditional:!1,xhrFields:{withCredentials:!0}}),registerEventMessages()},document.getElementsByTagName("head")[0].appendChild(t)}},getBrowserPrefix=function(){if("hidden"in document)return null;for(var t=["moz","ms","o","webkit"],e=0;e<t.length;e++){if(t[e]+"Hidden"in document)return t[e]}return null},hiddenProperty=function(t){return t?t+"Hidden":"hidden"},visibilityEvent=function(t){return t?t+"visibilitychange":"visibilitychange"},registerEventMessages=function(){jq(window).bind("message",function(t){if(t.originalEvent&&t.originalEvent.data&&t.originalEvent.origin&&rp.chat.Core.getRPDomain()&&rp.chat.Core.getRPDomain("dialog")&&(rp.chat.Core.getRPDomain().replace("/system","")===t.originalEvent.origin||rp.chat.Core.getRPDomain("dialog").replace("/system","")===t.originalEvent.origin)){var e=t.originalEvent.data;switch(e.type){case"changeElementHeightRelative":jq(e.id).height(jq(e.id).height()+e.size)}}})},triggerEvent=function(t,e,o){var n=document.createEvent("CustomEvent");n.initCustomEvent(e,!0,!0,o),t.dispatchEvent(n)},prefix=getBrowserPrefix(),hidden=hiddenProperty(prefix),visibilityEvent=visibilityEvent(prefix),tabActive=1;void 0!==document[hidden]&&document.addEventListener(visibilityEvent,function(){document[hidden]?tabActive=0:(tabActive=1,1==jq("#optiRealPersonChatContent").length&&rp.chat.Core.loadLayerChatModule())}),this.setRpFp=function(){return rp.chat.Core.getJQ().ajax({dataType:rp.chat.Core.AjaxDataType,type:"post",cache:!1,url:urlCollect+"/scripts/setRpFp.php",data:{deptid:rp.chat.Core.getDeptId(),session_rp:rp.chat.Core.getSessionRp(),sid_opti:rp.chat.Core.getSidOpti(),rpfp:rp.chat.Core.getFp()}}).done(function(t){}).fail(function(t,e,o){}),!1},loadJQuery(),isValidCookieSession(),this.loadConfig()},rp.chat.ChatModul=function(){this.startPopupChat=function(t,e,o,n){var i="",a="",r=rp.chat.Core.getRPDomain("dialog")+"/redirect.php?action=offlineurl&session_rp="+rp.chat.Core.getSessionRp()+"&deptid="+rp.chat.Core.getDeptId();if(o.onlinestatus||!t||!o.onlinestatus&&t&&void 0===o.offlineUrl){a="location=no,menubar=no,scrollbars=no,resizable=1,screenX=50,screenY=100,width="+this.getChatWidth()+",height="+this.getChatHeight(),i=rp.chat.Core.getSidOpti();var s="";o.campaign_active&&(s="&campaign_active=1&campaign_origin="+o.campaign_data.type+"&campaign_id="+o.campaign_data.campaign_id),r=rp.chat.Core.getRPDomain("dialog")+"/order.php?pageurl="+rp.chat.Core.getCurrentUrl()+"&deptid="+rp.chat.Core.getDeptId()+"&session_rp="+rp.chat.Core.getSessionRp()+"&pagename="+rp.chat.Core.getPagename()+"&invitetyp="+t+"&chat_type="+e+"&sid_opti="+rp.chat.Core.getSidOpti()+"&adblock_detected="+("function"==typeof rp.chat.Core.getAdBlockDetected?rp.chat.Core.getAdBlockDetected():0)+"&businessruleid="+n+"&iswebrtc="+rp.chat.Core.getWebRTCDetected()+"&rpfp="+rp.chat.Core.getFp()+s}window.open(r,i,a)},this.startMobileChat=function(t,e,o,n){var i=rp.chat.Core.getRPDomain("dialog")+"/redirect.php?action=offlineurl&session_rp="+rp.chat.Core.getSessionRp()+"&deptid="+rp.chat.Core.getDeptId();if(o.onlinestatus||!t||!o.onlinestatus&&t&&void 0===o.offlineUrl){var a="";o.campaign_active&&(a="&campaign_active=1&campaign_origin="+o.campaign_data.type+"&campaign_id="+o.campaign_data.campaign_id),i=rp.chat.Core.getRPDomain("dialog")+"/mobile/order.php?pageurl="+rp.chat.Core.getCurrentUrl()+"&deptid="+rp.chat.Core.getDeptId()+"&session_rp="+rp.chat.Core.getSessionRp()+"&pagename="+rp.chat.Core.getPagename()+"&invitetyp="+t+"&chat_type="+e+"&sid_opti="+rp.chat.Core.getSidOpti()+"&adblock_detected="+("function"==typeof rp.chat.Core.getAdBlockDetected?rp.chat.Core.getAdBlockDetected():0)+"&businessruleid="+n+"&rpfp="+rp.chat.Core.getFp()+a}window.open(i)},this.getChatWidth=function(){var t=rp.chat.Core.getConfig();return void 0!==t.chatWindow&&void 0!==t.chatWindow.size&&void 0!==t.chatWindow.size.width?t.chatWindow.size.width:450},this.getChatHeight=function(){var t=rp.chat.Core.getConfig(),e=void 0!==t.chatWindow&&void 0!==t.chatWindow.size&&void 0!==t.chatWindow.size.height?t.chatWindow.size.height:430;return this.checkBrowserForSafari()?350:e},this.checkBrowserForSafari=function(){var t=navigator.userAgent.toLowerCase();return-1!==t.indexOf("safari")&&-1===t.indexOf("chrome")}},window.rpChatConfig&&"function"!=typeof rpChatConfig.checkTrackingAllowed){var allowed=void 0===rpChatConfig.checkTrackingAllowed||!!rpChatConfig.checkTrackingAllowed;rpChatConfig.checkTrackingAllowed=function(){allowed=!1;var t=function(t){var e=document.cookie,o=e.indexOf(t);if(-1!=o){o+=t.length;var n=-1!=e.indexOf(";",o)?e.indexOf(";",o):e.length,i=e.substring(o,n);if(""!=i&&0!=i.trim().length)return i}return!1}("PRIVACY_CONSENT=");if(0!=t)try{var e=window.atob(t),o=window.JSON.parse(e);"object"==typeof o&&void 0!==o.marketing&&(allowed=!!o.marketing)}catch(t){}return allowed}}!1===rp.chat.isInitiated&&rp.chat.loadModules()}
//# sourceMappingURL=loadchatmodul.js.map
